<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Framework + Supabase + vercel</title>

<!-- Dùng cho appp.js --
<link rel="stylesheet" href="tasks.css">
<!---->

<!-- Dùng cho MyTasks.js --
<link rel="stylesheet" href="TasksStyle.css">
<!---->

<!-- Dùng cho PublicTasks.js --
<link rel="stylesheet" href="PublicTasks.css">
<!---->


  <style>

  </style>
</head>
<body>
  <div id="app"></div>

<!-- Framework -->
<script src="./framework/Debugger.js"></script>
<script src="./framework/vdom.js"></script>
<script src="./framework/hooks.js"></script>
<script src="./framework/router.js"></script>
<!----
<script src="./framework/init_API.js"></script>
<!---->


<!-- INIT SUPABASE TRƯỚC -->
<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

  const supabase = createClient(
    'https://defkqhylqphoqiikvbii.supabase.co', 'sb_publishable_vzdQpgqjLL2VE0Oyc0kEJQ_P8XqBwkh'
  );

  // Lưu vào window nếu cần các file khác dùng (không khuyến khích lắm, tốt nhất dùng import)
  window.supabase = supabase;

  console.log('Supabase client initialized');

  // Cách load script theo thứ tự và chờ nhau (cách đơn giản nhất)
  async function loadScriptsInOrder() {
    const scripts = [
      './framework/init_API.js',
      'userDashboard.js',   // đăng nhập + user info trước
      'MyTasks.js',         // cần user để test db
      'Home.js'             // routing + UI cuối cùng
    ];

    for (const src of scripts) {
      await new Promise((resolve, reject) => {
        const script = document.createElement('script');
        //script.type = 'module'; // rất quan trọng nếu file dùng import/export
        script.src = src;
        script.onload = () => {
          console.log(`Loaded: ${src}`);
          resolve();
        };
        script.onerror = () => {
          console.error(`Failed to load: ${src}`);
          reject();
        };
        document.body.appendChild(script);
      });
    }

    console.log('All core scripts loaded!');
    // Có thể dispatch event để báo cho app biết đã sẵn sàng
    window.dispatchEvent(new Event('app:ready'));
  }

  // Chạy sau khi supabase sẵn sàng
  loadScriptsInOrder().catch(err => {
    console.error('Critical error loading application scripts', err);
  });
</script>
<!---->

</body>
</html>

<!----
https://framework-frontend-vdom-v01.vercel.app/postsnew
<!---->